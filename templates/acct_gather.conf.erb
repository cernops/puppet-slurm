<%# acct_gather.conf.erb                                                     -%>
<%#                                                                          -%>
<%# Parameters for SLURM's AcctGatherEnergy/impi plugin.                     -%>
<%#                                                                          -%>
<%# version 20170816                                                         -%>
<%#                                                                          -%>
<%# Copyright (c) CERN, 2016-2017                                            -%>
<%# Authors: - Philippe Ganz <phganz@cern.ch>                                -%>
<%#          - Carolina Lindqvist <calindqv@cern.ch>                         -%>
<%#          - Pablo Llopis <pablo.llopis@cern.ch>                           -%>
<%# License: GNU GPL v3 or later.                                            -%>
<%#                                                                          -%>
# /etc/slurm/acct_gather.conf generated by puppet
#
# Parameters for AcctGather* plugins
#

# Options used for AcctGatherEnergyType/ipmi
<% if @with_energy_ipmi -%>
EnergyIPMIFrequency=<%= @energy_ipmi_frequency %>
EnergyIPMICalcAdjustment=<%= @energy_ipmi_calc_adjustment %>
<%# comment out if empty, process hash otherwise                             -%>
<% if @energy_ipmi_power_sensors.nil? -%>
#EnergyIPMIPowerSensors=
<% else -%>
EnergyIPMIPowerSensors=<%= @energy_ipmi_power_sensors.map{|pair| pair.join('=')}.join(';') %>
<% end -%>
<%#                                                                          -%>
<%= @energy_ipmi_username.nil? ? '#EnergyIPMIUsername=' : ('EnergyIPMIUsername=' + @energy_ipmi_username) %>
<%= @energy_ipmi_password.nil? ? '#EnergyIPMIPassword=' : ('EnergyIPMIPassword=' + @energy_ipmi_password) %>
<% else -%>
#EnergyIPMIFrequency=
#EnergyIPMICalcAdjustment=
#EnergyIPMIPowerSensors=
#EnergyIPMIUsername=
#EnergyIPMIPassword=
<% end -%>

# Options used for AcctGatherProfileType/hdf5
<% if @with_profile_hdf5 -%>
ProfileHDF5Dir=<%= @profile_hdf5_dir %>
ProfileHDF5Default=<%= @profile_hdf5_default %>
<% else -%>
#ProfileHDF5Dir=
#ProfileHDF5Default=
<% end -%>

# Options used for AcctGatherInfinbandType/ofed
<% if @with_interconnect_ofed -%>
InfinibandOFEDPort=<%= @interconnect_ofed_port %>
<% else -%>
#InfinibandOFEDPort=
<% end %>

# Options used for AcctGatherProfileType/influxdb
<% if @with_profile_influxdb -%>
ProfileInfluxDBHost=<%= @profile_influxdb_host %>
ProfileInfluxDBDatabase=<%= @profile_influxdb_db %>
<%= @profile_influxdb_username.nil? ? '#ProfileInfluxDBUser=' : ('ProfileInfluxDBUser=' + @profile_influxdb_username) %>
<%= @profile_influxdb_password.nil? ? '#ProfileInfluxDBPass=' : ('ProfileInfluxDBPass=' + @profile_influxdb_password) %>
ProfileInfluxDBDefault=<%= @profile_influxdb_default %>
ProfileInfluxDBRTPolicy=<%= @profile_influxdb_rtpolicy %>
<% else -%>
# ProfileInfluxDBDatabase=
# ProfileInfluxDBDefault=
# ProfileInfluxDBHost=
# ProfileInfluxDBPass=
# ProfileInfluxDBRTPolicy=
# ProfileInfluxDBUser=
<% end -%>
